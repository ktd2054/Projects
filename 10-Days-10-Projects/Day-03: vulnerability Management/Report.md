# ğŸ›¡ï¸ Vulnerability Management

---

## ğŸ¯ Objectives

- ğŸ§© Design and document a vulnerability management process  
- ğŸ” Configure and run Nessus vulnerability scans  
- ğŸ› ï¸ Troubleshoot failed authentication and scan issues  
- ğŸ“Š Analyse vulnerabilities and identify false positives  

---

## ğŸš€ Installing Nessus

- â¬‡ï¸ Download Nessus from the official Tenable website:  
  ğŸ‘‰ https://www.tenable.com/downloads/nessus?loginAttempted=true  
- ğŸ’» Install Nessus using the Linux terminal  
- ğŸ“ Navigate to the **Downloads** directory and install Nessus using `dpkg`

<img width="611" height="333" alt="image" src="https://github.com/user-attachments/assets/6e93c059-54b4-49e6-9590-a1b894a403d1" />

- â–¶ï¸ Start the Nessus service using the following command:  
  `/bin/systemctl start nessusd.service`

<img width="667" height="422" alt="image" src="https://github.com/user-attachments/assets/be1709d9-f48c-4aab-ad79-35e1c3ee9b79" />

- âœ… Verify that the Nessus service is running by executing:  
  `sudo /bin/systemctl status nessusd.service`  
  The service status should show **ğŸŸ¢ active (running)**

- ğŸŒ Open a web browser and navigate to:  
  `https://localhost:8834`
- âš ï¸ Accept the browser security warning to proceed  
- â¡ï¸ Click **Continue** and select **Nessus Professional**  
- ğŸ“§ Complete the setup using your email address  

<img width="1700" height="442" alt="image" src="https://github.com/user-attachments/assets/7d0814d0-5c2d-46f5-af23-4a963ffae69c" />

---

## ğŸ–¥ï¸ Setting up VMS

Virtual machines are configured on a small internal network to enable communication and vulnerability scanning.  
All systems are placed within the **same IP address range** to ensure proper connectivity.

### ğŸ§± Lab Environment

- ğŸŸ¦ **Domain Server Controller:** DC01  
- ğŸŒ **Web Server:** Web01  
- ğŸ§ **Linux Machine:** Kali01  
- ğŸªŸ **Windows 11 Client:** Win11  
- ğŸ–¥ï¸ **Windows Server 2025:** WinS2025  

<img width="651" height="578" alt="image" src="https://github.com/user-attachments/assets/be064d61-45c8-4af5-8984-5b838e711733" />

---

## âš™ï¸ Setting up Scanning Policy

- ğŸ§­ To perform vulnerability scans, a scanning policy must be configured  
- ğŸ“‚ Navigate to **Resources â†’ Policies** from the Nessus sidebar  
- ğŸ“‹ Review the available policies and select or customise one based on scanning requirements  
- ğŸ” Credentialed scans require valid domain user accounts  

---

## ğŸ‘¤ Setting up users to perform credentials scan

- â• Create a new user account on the domain controller **DC01**

<img width="428" height="384" alt="image" src="https://github.com/user-attachments/assets/cfe46007-2700-4bc8-920b-4554d12f5d17" />

- ğŸ”‘ Configure the same user as a **local administrator** on other systems such as  
  **Web01, Win11, and additional machines**  
- ğŸ›¡ï¸ Grant the user administrative privileges by adding it to the  
  **Domain Admins** group on **DC01**  

âœ… This configuration enables Nessus to perform authenticated scans and collect detailed system information.

### ğŸ” Performing Credential Scan

---

- Navigate to **Policies â†’ New Policy â†’ Basic Network Scan**
- Under the **Settings** tab, provide a suitable name for the scan policy

<img width="789" height="314" alt="image" src="https://github.com/user-attachments/assets/0034cde3-3ced-451f-880b-54f6e49cc8e8" />

- Go to the **Credentials** tab  
- Select **Windows** and enter the **Username and credentials** of the domain user created earlier

<img width="1321" height="457" alt="image" src="https://github.com/user-attachments/assets/c8b87b61-b5eb-4efb-9112-d3750f2e0174" />

- Return to the **Settings** tab  
- Scroll down to **Report**  
- Under **Output**, enable **Designate hosts by their DNS name**  
- Save the policy

---

### ğŸ“‚ Scan Folder Structure

- Navigate to **All Scans** from the sidebar  
- Create two folders:
  - **External Facing** â€“ for daily scans
  - **Internal Facing** â€“ for weekly scans

<img width="679" height="293" alt="image" src="https://github.com/user-attachments/assets/93b5c5b1-1a7f-4199-ae9f-16b0641023c7" />

---

### ğŸŒ External Facing Scan

- Go to **External Facing â†’ New Scan**
- Select **User Defined**
- Choose the previously saved scan policy
- Enter the **IP address of the external-facing system**

In this case, the IP address of the web server **Web01** is used.

<img width="990" height="546" alt="image" src="https://github.com/user-attachments/assets/ecce8c3f-2040-4461-ad5d-d982a15e6fdf" />

- Open **Schedule**
- Enable the schedule toggle
- Set the frequency to **Daily**
- Save the scan
- Click the â–¶ï¸ **Play** button to run the scan

---

### ğŸ¢ Internal Facing Scan

- Navigate to **Internal Facing â†’ New Scan**
- Select **User Defined**
- Enter the **IP addresses of internal machines**

<img width="1217" height="606" alt="image" src="https://github.com/user-attachments/assets/93c49067-30ac-46fc-bffa-329e179dffea" />

- Click the â–¶ï¸ **Play** button to start the scan

---

### ğŸ“Š External Facing Scan Results

<img width="1202" height="322" alt="image" src="https://github.com/user-attachments/assets/36ebff54-8df6-4a14-9570-77b15e7cf5be" />
<img width="1271" height="632" alt="image" src="https://github.com/user-attachments/assets/0829a519-c488-4bac-b1b6-735fd7eb7749" />

- âŒ Authentication failed  
- The scan was unable to perform a **deep credentialed assessment**
- Results are limited to non-authenticated checks

---

### ğŸ“Š Internal Facing Scan Results

<img width="1195" height="363" alt="image" src="https://github.com/user-attachments/assets/63e68170-76d0-45d3-8da7-082bc3d006c1" />
<img width="1219" height="610" alt="image" src="https://github.com/user-attachments/assets/be70368f-fc54-4aa4-8425-61d3f129853f" />

- âœ… Authentication succeeded on **one host**
- The authenticated host reported **215 vulnerabilities**
- âŒ Authentication failed on other hosts, resulting in partial scan visibility
