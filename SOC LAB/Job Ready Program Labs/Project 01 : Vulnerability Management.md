# Vulnerability Management

### Objectives

- Designing and documenting vulnerability management process
- Configuring and running Nessus vulnerability scans
- Troubleshoot failed authentication and scan issues
- Analysing and identifying false positives

### Installing Nessus

- Installing Nessus from https://www.tenable.com/downloads/nessus?loginAttempted=true
- now lets install from terminal
- go to downloads folder and use dpkg to install it

<img width="611" height="333" alt="image" src="https://github.com/user-attachments/assets/6e93c059-54b4-49e6-9590-a1b894a403d1" />

- lets start the nessus service using /bin/systemctl start nessusd.service

<img width="667" height="422" alt="image" src="https://github.com/user-attachments/assets/be1709d9-f48c-4aab-ad79-35e1c3ee9b79" />

- confirm it is running by sudo /bin/systemctl status nessusd.service as in the image above it says active(running)

- navigate to browser and go to uri https://localhost:8834
- go ahead and accept the risk to access nessus
- click continue and select nessus professional
- setup with email and continue

<img width="1700" height="442" alt="image" src="https://github.com/user-attachments/assets/7d0814d0-5c2d-46f5-af23-4a963ffae69c" />


### Setting up VMS

Now setting up VM machines on a small network to make connection and communication between them. In order to make that happen they should be under same range of IP addresses.

- domain server contoller named DC01
- web server named Web01
- linux machine Kali01
- windows 11 workstation named Win11
- windows Server 2025 named WinS2025

<img width="651" height="578" alt="image" src="https://github.com/user-attachments/assets/be064d61-45c8-4af5-8984-5b838e711733" />

### Setting up Scanning Policy 

- To perform scan we have to setup policy. Go to Policies under Resources on the sidebar.
- Review those policies and to perform the scan we have to set up users in our domain.

### Setting up users to perform credentials scan

- Set up a new user in domain controller DC01
<img width="428" height="384" alt="image" src="https://github.com/user-attachments/assets/cfe46007-2700-4bc8-920b-4554d12f5d17" />
- Next, Setting up the same user as local admin to other machines such as Web01, Win11, .. so on. by adding the user as the member of Domain Admins in our domain controller DC01.

### Performing Credential Scan

- Go to policies -> new policy -> basic network scan
- Under settings tab, give a suitable name.
<img width="789" height="314" alt="image" src="https://github.com/user-attachments/assets/0034cde3-3ced-451f-880b-54f6e49cc8e8" />
- Under credentials tab, click windows -> fill up Username (same as the new user we created) and the details

<img width="1321" height="457" alt="image" src="https://github.com/user-attachments/assets/c8b87b61-b5eb-4efb-9112-d3750f2e0174" />

- back to settings tab, go to report scroll down and under Output -> check Designate hosts by their DNS name -> save
- Next, go to All Scans on the sidebar -> create 2 folders; one named External Facing for daily scans and other Internal Facing for weekly scan

<img width="679" height="293" alt="image" src="https://github.com/user-attachments/assets/93b5c5b1-1a7f-4199-ae9f-16b0641023c7" />

#### External Facing

- -> Go to External Facing -> New Scan -> User Defined tab -> click on our previous saved scan -> enter Ip address of targets 

- here, I will insert Ip address for our web server Web01
  
<img width="990" height="546" alt="image" src="https://github.com/user-attachments/assets/ecce8c3f-2040-4461-ad5d-d982a15e6fdf" />

- click on schedule and trun on the toggle; set frequency daily -> and save.
- go to external facing and click play button on the table to run the scan
  
#### Internal Facing

- click on Internal Facing -> create New Scan -> User Defined -> and now enter Ip addresses of other machines

<img width="1217" height="606" alt="image" src="https://github.com/user-attachments/assets/93c49067-30ac-46fc-bffa-329e179dffea" />

- press the play button 


#### External Facing Scan result

<img width="1459" height="541" alt="image" src="https://github.com/user-attachments/assets/bd124ae2-fdb7-4d0c-b654-91ea1c7250b7" />

<img width="1173" height="611" alt="image" src="https://github.com/user-attachments/assets/3fedea90-0166-4dbc-818d-31e524ee1e5c" />

#### Internal Facing Scan result







