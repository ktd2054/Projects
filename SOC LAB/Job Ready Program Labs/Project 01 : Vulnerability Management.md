# Vulnerability Management

## Project Overview

This project demonstrates the implementation of a Vulnerability Management System (VMS) using Tenable Nessus in a small enterprise-style lab environment. The lab simulates real-world infrastructure with multiple Windows and Linux systems, enabling credentialed and non-credentialed vulnerability scans, analysis of scan failures, and hands-on troubleshooting of authentication issues.

---

## Objectives

- Design and document a vulnerability management process
- Configure and run Nessus vulnerability scans
- Troubleshoot failed authentication and scan issues
- Analyse vulnerabilities and identify false positives

---

## Installing Nessus

- Download Nessus from:
  https://www.tenable.com/downloads/nessus?loginAttempted=true
- Install Nessus using the Linux terminal
- Navigate to the Downloads directory and install Nessus using `dpkg`

<img width="611" height="333" alt="image" src="https://github.com/user-attachments/assets/6e93c059-54b4-49e6-9590-a1b894a403d1" />

- Start the Nessus service using:
/bin/systemctl start nessusd.service

<img width="667" height="422" alt="image" src="https://github.com/user-attachments/assets/be1709d9-f48c-4aab-ad79-35e1c3ee9b79" />

- Confirm the service is running:
  sudo /bin/systemctl status nessusd.service

  - Accept the browser security warning
- Click Continue and select Nessus Professional
- Complete the setup using your email

<img width="1700" height="442" alt="image" src="https://github.com/user-attachments/assets/7d0814d0-5c2d-46f5-af23-4a963ffae69c" />

---

## Setting up VMS

Virtual machines are configured on a small internal network to enable communication and vulnerability scanning. All systems are placed within the same IP address range.

The lab environment consists of:

- Domain Server Controller: DC01
- Web Server: Web01
- Linux Machine: Kali01
- Windows 11 Workstation: Win11
- Windows Server 2025: WinS2025

<img width="651" height="578" alt="image" src="https://github.com/user-attachments/assets/be064d61-45c8-4af5-8984-5b838e711733" />

---

## Setting up Scanning Policy

- Navigate to Resources → Policies in Nessus
- Review available policies
- Configure a policy suitable for credentialed scanning
- Credentialed scans require valid domain user accounts

---

## Setting up Users for Credentialed Scans

- Create a new user account on the domain controller DC01

<img width="428" height="384" alt="image" src="https://github.com/user-attachments/assets/cfe46007-2700-4bc8-920b-4554d12f5d17" />

- Configure the same user as local administrator on:
- Web01
- Win11
- Other domain-joined machines
- Add the user to the Domain Admins group on DC01

This ensures Nessus has sufficient privileges to perform authenticated scans.

---

## Performing Credential Scan

- Go to Policies → New Policy → Basic Network Scan
- Under the Settings tab, provide a suitable name

<img width="789" height="314" alt="image" src="https://github.com/user-attachments/assets/0034cde3-3ced-451f-880b-54f6e49cc8e8" />

- Open the Credentials tab
- Select Windows and enter the domain user credentials

<img width="1321" height="457" alt="image" src="https://github.com/user-attachments/assets/c8b87b61-b5eb-4efb-9112-d3750f2e0174" />

- Return to the Settings tab
- Scroll to Report → Output
- Enable “Designate hosts by their DNS name” and save

---

## Scan Organisation

- Go to All Scans
- Create two folders:
- External Facing – daily scans
- Internal Facing – weekly scans

<img width="679" height="293" alt="image" src="https://github.com/user-attachments/assets/93b5c5b1-1a7f-4199-ae9f-16b0641023c7" />

---

## External Facing Scan

- Go to External Facing → New Scan → User Defined
- Select the saved scan policy
- Enter the IP address of the web server Web01

<img width="990" height="546" alt="image" src="https://github.com/user-attachments/assets/ecce8c3f-2040-4461-ad5d-d982a15e6fdf" />

- Enable scheduling
- Set frequency to Daily
- Save and run the scan using the play button

---

## Internal Facing Scan

- Go to Internal Facing → New Scan → User Defined
- Enter IP addresses of internal machines

<img width="1217" height="606" alt="image" src="https://github.com/user-attachments/assets/93c49067-30ac-46fc-bffa-329e179dffea" />

- Run the scan using the play button

---

## External Facing Scan Result

<img width="1202" height="322" alt="image" src="https://github.com/user-attachments/assets/36ebff54-8df6-4a14-9570-77b15e7cf5be" />
<img width="1271" height="632" alt="image" src="https://github.com/user-attachments/assets/0829a519-c488-4bac-b1b6-735fd7eb7749" />

- Authentication failed
- Deep credentialed scanning was not performed
- Results were limited to non-authenticated checks

---

## Internal Facing Scan Result

<img width="1195" height="363" alt="image" src="https://github.com/user-attachments/assets/63e68170-76d0-45d3-8da7-082bc3d006c1" />
<img width="1219" height="610" alt="image" src="https://github.com/user-attachments/assets/be70368f-fc54-4aa4-8425-61d3f129853f" />

- Authentication succeeded on one host
- The authenticated host reported 215 vulnerabilities
- Authentication failed on other hosts

### Why 215 Vulnerabilities Were Detected

The credentialed scan was able to enumerate installed software, identify missing security patches, and access registry and system-level information. This provides significantly deeper visibility compared to non-credentialed scans.

---

## Why the Scan Failed and How It Was Troubleshot

Authentication failures typically occur when required services, permissions, or firewall rules are not correctly configured.

### Troubleshooting Performed

- Verified credentials by logging in as the SVC_Nessus user
- Followed Tenable troubleshooting documentation:
https://connect.tenable.com/kb/tenable-connect-support/troubleshooting-credentialed-scanning-on-windows/110112

---

## Troubleshooting Steps

### Services (Win + R → services.msc)

1. Ensure Windows Management Instrumentation (WMI) is running
2. Enable Remote Registry service if disabled

### File and Printer Sharing

- Enabled file and printer sharing on Private and Public networks

### Windows Defender Firewall

- Enabled inbound rules for:
- TCP port 139
- TCP port 445

---

## Fixed State

<img width="1655" height="586" alt="image" src="https://github.com/user-attachments/assets/df54be15-97b4-4674-9838-f3aeacf2596f" />
